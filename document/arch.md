# 系统架构设计文档

| 作者 | 版本 |  日期 | 改动
|----|:----:|:-----|-----
| xx | V1.0 | 2016-02-25 | 初始版本

[本文档根据系统的业务流程对系统进行模块划分、架构设计、难点分析等，是最为核心的一个文档。]

## 一. 前言

[这里主要定义一些系统相关的概念和名词，也可以描述一下系统的需求]

## 二. 总体设计

[这里给出总体架构设计图，描述系统有哪几个模块组成，每个模块间的交互、数据流向、存储架构等]

[这里也可以给出系统的软件层面架构设计，即基于那些软件服务，之间的关系如何]

模块组成：

1. 模块一：模块一的描述
2. 模块二：模块二的描述

## 三. 模块设计

### 3.1 模块一

[描述模块一的核心流程、技术关键点等]

1. 核心流程

1. 技术关键点

### 3.2 模块二

[描述模块二的核心流程、技术关键点等]

## 四. 存储设计

[给出总体的存储架构，如：本地缓存+Redis缓存+MySQL。描述使用到数据库、缓存、消息队列、搜索引擎并量化。]

### 4.1 数据库设计

**表名**：wl_user

**分区策略**：[描述是水平分区还是垂直分区，哪一个属性是策略因子等]

| 属性 | 数据类型 |  是否主键| 自增 | 描述 | 备注
|----|:----:|:----- |:---- |:---- | :----
| id | bigint(20) | 是 | mysql自增/redis发号器 | 用户ID
| name | varchar | 否 | 否|名称
| city | varchar | 否 | 否| 所在城市

### 4.2 缓存量化分析

| key | 数据结构 |  数量 | 大小 | 有效期 | 读写峰值QPS | 备注
|----|:----:|:----- |:---- |:---- | :---- | :----
| user.count | long | 用户数 |  用户数 x 8 kb | 长久 | 写：200qps 读：30000qps | 记录用户的总数
| user.queue| List | 1 | 500 x 100 kb | 半年 | 写：10000qps 读：100qps | 每一个元素为json字符串大约为100byte，平均保持队列长度为500，消费者为quartz线程每隔1秒消费100个元素| 
	
综上，Redis需要预留xx内存，后续内存使用保持不变/持续增加（如果持续增加，需要给出增加趋势）。

## 五. 系统容量规划
 
[预估系统容量，供运维部署服务节点。包括预估业务最大流量（峰值QPS/连接数）、预估单机承载能力、需要的机器数目以及超流量后的流量控制措施。容量规划实施流程见下图:

![](../images/capacity-plan.png)]

## 六. 技术难点

[这里描述系统存在的技术难点以及解决的方案]

## 七. 存在的问题

[这里主要列出目前未解决的问题，以及如何做好风险控制]

 
